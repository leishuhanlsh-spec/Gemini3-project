角色设定：
你是一位世界级的 Creative Technologist，精通 Three.js (WebGL)、GLSL 着色器逻辑以及 Google MediaPipe 计算机视觉集成。

任务目标：
请编写一个单文件 (Single-File) 的 HTML 项目，用来通过手势进行圣诞树不同形态的交互。该项目必须包含完整的 HTML 结构、CSS 样式和基于 ES Module 的 JavaScript 代码。

核心技术栈约束 (必须严格遵守)：
依赖管理： 使用 <script type="importmap"> 引入：
three: https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js
three/addons/: https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/
@mediapipe/tasks-vision: https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.3/+esm

代码风格： 使用现代 ES6+ 语法，类 (Class) 结构管理粒子，异步/等待 (Async/Await) 处理加载。

📝 详细开发规格说明书

1. UI 设计与 CSS 样式 (Visual Identity)
字体： 引入 Google Fonts 'Cinzel' (标题) 和 'Times New Roman' (正文)。
配色： 背景 #000000，并带有与圣诞树对应颜色的粒子，粒子大小不规则，使用荧光颜色。
香槟金 #d4af37，奶油白 #fceea7。

2. Three.js 场景构建 (Scene Setup)
渲染器： WebGLRenderer (antialias: true)，toneMapping 设置为 ReinhardToneMapping (曝光 2.2)。
相机： 透视相机。
环境 (Environment)： 使用 RoomEnvironment 配合 PMREMGenerator 生成高反射金属环境贴图。
后期处理 (Post-Processing)：
使用 EffectComposer。
添加 UnrealBloomPass (辉光特效)。
灯光系统：
AmbientLight 。
内部 PointLight (橙色, 强度 2)。
SpotLight (金色, 强度 1200, 位置 30,40,40)。
SpotLight (蓝色, 强度 600, 位置 -30,20,-30) 用于冷暖对比。

3. 粒子系统与内容 (Content Generation) - 3D 立体化重构
粒子总数： 提升至 12,000+ 以确保体积感。
几何体混合：
使用 InstancedMesh 配合 SphereGeometry (高光材质) 和 BoxGeometry，确保粒子在各个角度都有体积。

Demo 0：2D版圣诞树和模型
- 加载界面： 黑色全屏遮罩，带有雪花状以及圆形荧光粒子，大小不规则，奶油白 #fceea7，可以加少量酒红色，香槟金小粒子。正中间为精致的 CSS 动画图标（代替图片），展示圣诞树与礼物的抽象轮廓，圣诞树灯球可以发光，下方文字 "Merry Christmas"。初始化完成后淡出。

Demo 1: 3D 螺旋圆锥圣诞树 (Volumetric Spiral Tree)
- 核心结构：一个饱满的 3D 圆锥体。
- 粒子分布：粒子不应只停留在圆锥表面。它们应该构成一条或多条宽阔的、有厚度的金色螺旋光带，从底部盘旋至顶部。
- 顶部装饰：一个立体的、旋转的橙色五角星几何体（ExtrudeGeometry）。

Demo 2: 动态烟花与装饰 (Fireworks & Ornaments)
- 在 Demo 1 的基础上，树体内部和表面随机出现红色的发光粒子（灯球），增加层次感。
- 交互触发：张开手掌时，从树的中心向外发射 3D 烟花。
- 烟花效果：粒子应呈球形爆发（Spherical Explosion），受重力影响下落，带有拖尾效果，颜色为金、红、紫、蓝混合。

Demo 3: 水晶球微缩景观 (Crystal Ball Diorama)
- 核心结构：一个巨大的透明球体空间（由稀疏的粒子暗示边界）。
- 内部景观：
  - 双树布局：球内放置两棵小型的、完全立体的绿色粒子树（圆锥体体积填充），左右错落分布，产生景深。
  - 地面：底部铺设一层白色的粒子作为雪地，有厚度起伏。
  - 礼物：在树下堆放由密集粒子组成的立方体（红金配色），具有明确的长宽高体积。
  - 飘雪：球体内部有独立的白色粒子系统，进行受限的布朗运动，模拟飘雪。

4. 状态机与动画逻辑 (State Machine & Logic)
定义全局 STATE 对象，包含模式 (mode) 和手势数据。在 animate 循环中根据模式计算目标位置并使用 lerp 平滑过渡。
Mode 1 (默认): 3D 螺旋圆锥圣诞树。
Mode 2 (张开手掌): 在树上添加红灯球，并循环播放 3D 烟花特效。
Mode 3 (握拳): 场景重组为水晶球微缩景观。

5. MediaPipe 计算机视觉集成 (Computer Vision)
模型加载： 
使用 FilesetResolver 和 HandLandmarker (或本地 Hands API)。
手势识别算法 (Process Gestures)：
获取关键点：拇指(4), 食指(8), 手腕(0), 其他指尖(12,16,20)。
Open Hand (张开)： 四指尖到手腕平均距离 > 0.4 -> 触发 Demo 2 (烟花)。
Fist (握拳)： 四指尖到手腕平均距离 < 0.25 -> 触发 Demo 3 (水晶球)。
交互映射：
Rotation (旋转)： 将手掌中心 (Landmark 9) 的 X/Y 坐标映射为 3D 场景的 rotation.y 和 rotation.x，实现 360 度观察立体模型。
Zoom (缩放)： 根据手掌大小（Palm Size，手腕到中指根部的距离）控制相机距离。手掌靠近（变大）-> 相机拉近；手掌远离（变小）-> 相机拉远。

请输出完整的、包含所有这些细节的单文件 HTML 代码。